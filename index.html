<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>Take Profits Calculator</title>
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@picocss/pico@2/css/pico.min.css"/>
  <style>
    body { max-width: 800px; margin: auto; padding: 2rem; }
    .inputs { display: grid; grid-template-columns: repeat(auto-fit, minmax(200px, 1fr)); gap: 1rem; }
    .tp-grid { display: grid; grid-template-columns: repeat(2, 1fr); gap: 1rem; margin-top: 1rem; }
    .tp-block { border: 1px solid #333; border-radius: 8px; padding: 1rem; background: #1a1a1a; }
    .tp-block h4 { margin: 0 0 .5rem 0; font-size: 1rem; }
    .result { margin-top: 2rem; font-weight: bold; }
  </style>
</head>
<body>
  <h1>Take Profits Calculator</h1>
  <p>Quickly test TP splits vs a capped stop. Mobile-friendly. No equations â€” just outcomes.</p>

  <form id="tp-form">
    <div class="inputs">
      <label>Trade size ($)<input type="number" id="tradeSize" value="200"/></label>
      <label>Stop loss cap (%)<input type="number" id="stopCap" value="6"/></label>
      <label># of Take Profits
        <select id="numTPs">
          <option value="1">1 TP</option>
          <option value="2">2 TPs</option>
          <option value="3" selected>3 TPs</option>
        </select>
      </label>
    </div>
    <button type="button" id="calculate">Calculate</button>
  </form>

  <div id="tp-container"></div>
  <div id="results" class="result"></div>

  <script>
    const tpContainer = document.getElementById("tp-container");
    const numTPs = document.getElementById("numTPs");
    const calcBtn = document.getElementById("calculate");
    const results = document.getElementById("results");

    function renderTPInputs() {
      tpContainer.innerHTML = "";
      const n = parseInt(numTPs.value);
      for (let i=1; i<=n; i++) {
        const block = document.createElement("div");
        block.className = "tp-block";
        block.innerHTML = `
          <h4>TP${i}</h4>
          <label>Allocation (%)<input type="number" id="alloc${i}" min="0" max="100"/></label>
          <label>Gain target (%)<input type="number" id="target${i}" min="0"/></label>
        `;
        tpContainer.appendChild(block);
      }
      tpContainer.className = "tp-grid";
    }

    function calculate() {
      const n = parseInt(numTPs.value);
      let allocSum = 0;
      for (let i=1; i<=n; i++) {
        allocSum += parseFloat(document.getElementById(`alloc${i}`).value || 0);
      }
      const remainder = 100 - allocSum;
      results.textContent = `Current sum = ${allocSum.toFixed(2)}%. Remainder = ${remainder.toFixed(2)}% (stops at cap).`;
      results.style.color = allocSum>100 ? "red" : "lightgreen";
    }

    numTPs.addEventListener("change", renderTPInputs);
    calcBtn.addEventListener("click", calculate);

    renderTPInputs();
  </script>
</body>
</html>
